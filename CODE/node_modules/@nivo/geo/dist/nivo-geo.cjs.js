"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@nivo/core"),t=require("@nivo/tooltip"),o=require("prop-types"),i=require("@nivo/colors"),n=require("lodash/get"),a=require("lodash/isFunction"),u=require("d3-format"),l=require("d3-geo"),s=require("@nivo/legends"),d=require("react/jsx-runtime");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=c(o),p=c(n),h=c(a);function g(){return g=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},g.apply(this,arguments)}var v={azimuthalEqualArea:l.geoAzimuthalEqualArea,azimuthalEquidistant:l.geoAzimuthalEquidistant,gnomonic:l.geoGnomonic,orthographic:l.geoOrthographic,stereographic:l.geoStereographic,equalEarth:l.geoEqualEarth,equirectangular:l.geoEquirectangular,mercator:l.geoMercator,transverseMercator:l.geoTransverseMercator,naturalEarth1:l.geoNaturalEarth1},C=function(t){var o=t.width,n=t.height,a=t.projectionType,u=t.projectionScale,s=t.projectionTranslation,d=t.projectionRotation,c=t.fillColor,f=t.borderWidth,p=t.borderColor,h=e.useMemo((function(){return v[a]().scale(u).translate([o*s[0],n*s[1]]).rotate(d)}),[o,n,a,u,s[0],s[1],d[0],d[1],d[2]]),g=e.useMemo((function(){return l.geoPath(h)}),[h]),C=e.useMemo((function(){return l.geoGraticule()})),m=r.useTheme(),b=e.useMemo((function(){return"function"==typeof f?f:function(){return f}}),[f]),j=i.useInheritedColor(p,m),y=e.useMemo((function(){return"function"==typeof c?c:function(){return c}}),[c]);return{projection:h,path:g,graticule:C,getBorderWidth:b,getBorderColor:j,getFillColor:y}},m=function(t){var o=t.features,i=t.data,n=t.match,a=t.label,l=t.value,d=t.valueFormat,c=t.colors,f=t.unknownColor,v=t.domain,C=e.useMemo((function(){return h.default(n)?n:function(e,r){var t=p.default(e,n),o=p.default(r,n);return t&&t===o}}),[n]),m=e.useMemo((function(){return h.default(a)?a:function(e){return p.default(e,a)}}),[a]),b=e.useMemo((function(){return h.default(l)?l:function(e){return p.default(e,l)}}),[l]),j=e.useMemo((function(){return void 0===d?function(e){return e}:h.default(d)?d:u.format(d)}),[d]),y=e.useMemo((function(){return r.guessQuantizeColorScale(c).domain(v)}),[c,v]),R=e.useMemo((function(){return function(e){return void 0===e.value?f:y(e.value)}}),[y,f]),q=e.useMemo((function(){return o.map((function(e){var r=i.find((function(r){return C(e,r)})),t=b(r);if(r){var o=g({},e,{data:r,value:t,formattedValue:j(t)});return o.color=R(o),o.label=m(o),o}return e}))}),[o,i,C,b,j,R]),M=s.useQuantizeColorScaleLegendData({scale:y,valueFormat:j});return{colorScale:y,getFillColor:R,boundFeatures:q,valueFormatter:j,legendData:M}},b=e.memo((function(e){var r=e.feature;return void 0===r.data?null:d.jsx(t.BasicTooltip,{id:r.label,color:r.color,enableChip:!0,value:r.formattedValue})}));b.propTypes={feature:f.default.object.isRequired},b.displayName="ChoroplethTooltip";var j={features:f.default.arrayOf(f.default.shape({id:f.default.string.isRequired,type:f.default.oneOf(["Feature"]).isRequired,properties:f.default.object,geometry:f.default.object.isRequired})).isRequired,projectionType:f.default.oneOf(Object.keys(v)).isRequired,projectionScale:f.default.number.isRequired,projectionTranslation:f.default.arrayOf(f.default.number).isRequired,projectionRotation:f.default.arrayOf(f.default.number).isRequired,fillColor:f.default.oneOfType([f.default.string,f.default.func]).isRequired,borderWidth:f.default.oneOfType([f.default.number,f.default.func]).isRequired,borderColor:i.inheritedColorPropType.isRequired,enableGraticule:f.default.bool.isRequired,graticuleLineWidth:f.default.number.isRequired,graticuleLineColor:f.default.string.isRequired,isInteractive:f.default.bool.isRequired,onMouseEnter:f.default.func.isRequired,onMouseMove:f.default.func.isRequired,onMouseLeave:f.default.func.isRequired,onClick:f.default.func.isRequired,tooltip:f.default.any,layers:f.default.arrayOf(f.default.oneOfType([f.default.oneOf(["graticule","features"]),f.default.func])).isRequired},y=g({},j,{role:f.default.string.isRequired}),R=g({pixelRatio:f.default.number.isRequired},j),q={data:f.default.arrayOf(f.default.object).isRequired,match:f.default.oneOfType([f.default.string,f.default.func]).isRequired,label:f.default.oneOfType([f.default.string,f.default.func]).isRequired,value:f.default.oneOfType([f.default.string,f.default.func]).isRequired,valueFormat:f.default.oneOfType([f.default.string,f.default.func]),colors:r.quantizeColorScalePropType.isRequired,domain:f.default.arrayOf(f.default.number).isRequired,unknownColor:f.default.string.isRequired,layers:f.default.arrayOf(f.default.oneOfType([f.default.oneOf(["graticule","features","legends"]),f.default.func])).isRequired},M=g({},y,q,{role:f.default.string.isRequired}),T=g({},R,q),x={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[]},k=g({},x,{role:"img"}),W=g({},x,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),w={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:b,layers:["graticule","features","legends"]},F=g({},k,w,{role:"img"}),E=g({},W,w),S=e.memo((function(e){var r=e.path,t=e.graticule,o=e.lineWidth,i=e.lineColor;return d.jsx("path",{fill:"none",strokeWidth:o,stroke:i,d:r(t())})}));S.propTypes={path:f.default.func.isRequired,graticule:f.default.func.isRequired,lineWidth:f.default.number.isRequired,lineColor:f.default.string.isRequired},S.displayName="GeoGraticule";var O=e.memo((function(e){var r=e.feature,t=e.path,o=e.fillColor,i=e.borderWidth,n=e.borderColor,a=e.onClick,u=e.onMouseEnter,l=e.onMouseMove,s=e.onMouseLeave;return d.jsx("path",{fill:o,strokeWidth:i,stroke:n,strokeLinejoin:"bevel",d:t(r),onMouseEnter:function(e){return u(r,e)},onMouseMove:function(e){return l(r,e)},onMouseLeave:function(e){return s(r,e)},onClick:function(e){return a(r,e)}},r.id)}));O.propTypes={feature:f.default.shape({id:f.default.string.isRequired,type:f.default.oneOf(["Feature"]).isRequired,properties:f.default.object,geometry:f.default.object.isRequired}).isRequired,path:f.default.func.isRequired,fillColor:f.default.string.isRequired,borderWidth:f.default.number.isRequired,borderColor:f.default.string.isRequired,onMouseEnter:f.default.func.isRequired,onMouseMove:f.default.func.isRequired,onMouseLeave:f.default.func.isRequired,onClick:f.default.func.isRequired},O.displayName="GeoMapFeature";var L=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.features,l=o.layers,s=o.projectionType,c=o.projectionScale,f=o.projectionTranslation,p=o.projectionRotation,h=o.fillColor,g=o.borderWidth,v=o.borderColor,m=o.enableGraticule,b=o.graticuleLineWidth,j=o.graticuleLineColor,y=o.isInteractive,R=o.onClick,q=o.tooltip,M=o.role,T=r.useDimensions(i,n,a),x=T.margin,k=T.outerWidth,W=T.outerHeight,w=C({width:i,height:n,projectionType:s,projectionScale:c,projectionTranslation:f,projectionRotation:p,fillColor:h,borderWidth:g,borderColor:v}),F=w.graticule,E=w.path,L=w.getFillColor,G=w.getBorderWidth,P=w.getBorderColor,B=r.useTheme(),D=t.useTooltip(),I=D.showTooltipFromEvent,N=D.hideTooltip,z=e.useCallback((function(e,r){return y&&R&&R(e,r)}),[y,R]),H=e.useCallback((function(e,r){return y&&q&&I(d.jsx(q,{feature:e}),r)}),[y,I,q]),A=e.useCallback((function(e,r){return y&&q&&I(d.jsx(q,{feature:e}),r)}),[y,I,q]),Q=e.useCallback((function(){return y&&N()}),[y,N]);return d.jsx(r.SvgWrapper,{width:k,height:W,margin:x,theme:B,role:M,children:l.map((function(r,t){return"graticule"===r?!0!==m?null:d.jsx(S,{path:E,graticule:F,lineWidth:b,lineColor:j},"graticule"):"features"===r?d.jsx(e.Fragment,{children:u.map((function(e){return d.jsx(O,{feature:e,path:E,fillColor:L(e),borderWidth:G(e),borderColor:P(e),onMouseEnter:H,onMouseMove:A,onMouseLeave:Q,onClick:z},e.id)}))},"features"):d.jsx(e.Fragment,{children:r(o)},t)}))})}));L.displayName="GeoMap",L.propTypes=y,L.defaultProps=k;var G=r.withContainer(L),P=function(e,t,o,i){var n=r.getRelativeCursor(t,e),a=n[0],u=n[1];return o.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},B=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.pixelRatio,l=o.features,s=o.layers,c=o.projectionType,f=o.projectionScale,p=o.projectionTranslation,h=o.projectionRotation,g=o.fillColor,v=o.borderWidth,m=o.borderColor,b=o.enableGraticule,j=o.graticuleLineWidth,y=o.graticuleLineColor,R=o.isInteractive,q=o.onClick,M=o.onMouseMove,T=o.tooltip,x=e.useRef(null),k=r.useTheme(),W=r.useDimensions(i,n,a),w=W.margin,F=W.outerWidth,E=W.outerHeight,S=C({width:i,height:n,projectionType:c,projectionScale:f,projectionTranslation:p,projectionRotation:h,fillColor:g,borderWidth:v,borderColor:m}),O=S.projection,L=S.graticule,G=S.path,B=S.getFillColor,D=S.getBorderWidth,I=S.getBorderColor;e.useEffect((function(){if(x){x.current.width=F*u,x.current.height=E*u;var e=x.current.getContext("2d");e.scale(u,u),e.fillStyle=k.background,e.fillRect(0,0,F,E),e.translate(w.left,w.top),G.context(e),s.forEach((function(r){"graticule"===r?!0===b&&(e.lineWidth=j,e.strokeStyle=y,e.beginPath(),G(L()),e.stroke()):"features"===r?l.forEach((function(r){e.beginPath(),G(r),e.fillStyle=B(r),e.fill();var t=D(r);t>0&&(e.strokeStyle=I(r),e.lineWidth=t,e.stroke())})):r(e,o)}))}}),[x,F,E,w,u,k,G,L,B,D,I,l,s]);var N=t.useTooltip(),z=N.showTooltipFromEvent,H=N.hideTooltip,A=e.useCallback((function(e){if(R&&T){var r=P(e,x.current,l,O);r?z(d.jsx(T,{feature:r}),e):H(),M&&M(r||null,e)}}),[z,H,R,T,x,l,O]),Q=e.useCallback((function(){return R&&H()}),[R,H]),V=e.useCallback((function(e){if(R&&q){var r=P(e,x.current,l,O);r&&q(r,e)}}),[R,x,l,O,q]);return d.jsx("canvas",{ref:x,width:F*u,height:E*u,style:{width:F,height:E,cursor:R?"auto":"normal"},onMouseMove:A,onMouseLeave:Q,onClick:V})}));B.displatName="GeoMapCanvas",B.propTypes=R,B.defaultProps=W;var D=r.withContainer(B),I=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.features,l=o.data,c=o.match,f=o.label,p=o.value,h=o.valueFormat,v=o.projectionType,b=o.projectionScale,j=o.projectionTranslation,y=o.projectionRotation,R=o.colors,q=o.domain,M=o.unknownColor,T=o.borderWidth,x=o.borderColor,k=o.enableGraticule,W=o.graticuleLineWidth,w=o.graticuleLineColor,F=o.layers,E=o.legends,L=o.isInteractive,G=o.onClick,P=o.tooltip,B=o.role,D=r.useDimensions(i,n,a),I=D.margin,N=D.outerWidth,z=D.outerHeight,H=C({width:i,height:n,projectionType:v,projectionScale:b,projectionTranslation:j,projectionRotation:y,fillColor:function(){},borderWidth:T,borderColor:x}),A=H.graticule,Q=H.path,V=H.getBorderWidth,_=H.getBorderColor,J=m({features:u,data:l,match:c,label:f,value:p,valueFormat:h,colors:R,unknownColor:M,domain:q}),K=J.getFillColor,U=J.boundFeatures,X=J.legendData,Y=r.useTheme(),Z=t.useTooltip(),$=Z.showTooltipFromEvent,ee=Z.hideTooltip,re=e.useCallback((function(e,r){return L&&G&&G(e,r)}),[L,G]),te=e.useCallback((function(e,r){return L&&P&&$(d.jsx(P,{feature:e}),r)}),[L,$,P]),oe=e.useCallback((function(e,r){return L&&P&&$(d.jsx(P,{feature:e}),r)}),[L,$,P]),ie=e.useCallback((function(){return L&&ee()}),[L,ee]);return d.jsx(r.SvgWrapper,{width:N,height:z,margin:I,theme:Y,role:B,children:F.map((function(r,t){return"graticule"===r?!0!==k?null:d.jsx(S,{path:Q,graticule:A,lineWidth:W,lineColor:w},"graticule"):"features"===r?d.jsx(e.Fragment,{children:U.map((function(e){return d.jsx(O,{feature:e,path:Q,fillColor:K(e),borderWidth:V(e),borderColor:_(e),onMouseEnter:te,onMouseMove:oe,onMouseLeave:ie,onClick:re},e.id)}))},"features"):"legends"===r?E.map((function(e,r){return d.jsx(s.BoxLegendSvg,g({containerWidth:i,containerHeight:n,data:X},e),r)})):d.jsx(e.Fragment,{children:r({})},t)}))})}));I.displayName="Choropleth",I.propTypes=M,I.defaultProps=F;var N=r.withContainer(I),z=function(e,t,o,i){var n=r.getRelativeCursor(t,e),a=n[0],u=n[1];return o.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},H=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.pixelRatio,l=o.features,c=o.data,f=o.match,p=o.label,h=o.value,v=o.valueFormat,b=o.projectionType,j=o.projectionScale,y=o.projectionTranslation,R=o.projectionRotation,q=o.colors,M=o.domain,T=o.unknownColor,x=o.borderWidth,k=o.borderColor,W=o.enableGraticule,w=o.graticuleLineWidth,F=o.graticuleLineColor,E=o.layers,S=o.legends,O=o.isInteractive,L=o.onClick,G=o.onMouseMove,P=o.tooltip,B=e.useRef(null),D=r.useTheme(),I=r.useDimensions(i,n,a),N=I.margin,H=I.outerWidth,A=I.outerHeight,Q=C({width:i,height:n,projectionType:b,projectionScale:j,projectionTranslation:y,projectionRotation:R,fillColor:function(){},borderWidth:x,borderColor:k}),V=Q.projection,_=Q.graticule,J=Q.path,K=Q.getBorderWidth,U=Q.getBorderColor,X=m({features:l,data:c,match:f,label:p,value:h,valueFormat:v,colors:q,unknownColor:T,domain:M}),Y=X.getFillColor,Z=X.boundFeatures,$=X.legendData;e.useEffect((function(){if(B){B.current.width=H*u,B.current.height=A*u;var e=B.current.getContext("2d");e.scale(u,u),e.fillStyle=D.background,e.fillRect(0,0,H,A),e.translate(N.left,N.top),J.context(e),E.forEach((function(r){"graticule"===r?!0===W&&(e.lineWidth=w,e.strokeStyle=F,e.beginPath(),J(_()),e.stroke()):"features"===r?Z.forEach((function(r){e.beginPath(),J(r),e.fillStyle=Y(r),e.fill();var t=K(r);t>0&&(e.strokeStyle=U(r),e.lineWidth=t,e.stroke())})):"legends"===r&&S.forEach((function(r){s.renderLegendToCanvas(e,g({},r,{data:$,containerWidth:i,containerHeight:n,theme:D}))}))}))}}),[B,H,A,N,u,D,J,_,Y,K,U,Z,S,E]);var ee=t.useTooltip(),re=ee.showTooltipFromEvent,te=ee.hideTooltip,oe=e.useCallback((function(e){if(O&&P){var r=z(e,B.current,Z,V);r?re(d.jsx(P,{feature:r}),e):te(),G&&G(r||null,e)}}),[re,te,O,P,B,Z,V]),ie=e.useCallback((function(){return O&&te()}),[O,te]),ne=e.useCallback((function(e){if(O&&L){var r=z(e,B.current,Z,V);r&&L(r,e)}}),[O,B,Z,V,L]);return d.jsx("canvas",{ref:B,width:H*u,height:A*u,style:{width:H,height:A,cursor:O?"auto":"normal"},onMouseMove:oe,onMouseLeave:ie,onClick:ne})}));H.displayName="ChoroplethCanvas",H.propTypes=T,H.defaultProps=E;var A=r.withContainer(H);exports.Choropleth=N,exports.ChoroplethCanvas=A,exports.ChoroplethCanvasDefaultProps=E,exports.ChoroplethCanvasPropTypes=T,exports.ChoroplethDefaultProps=F,exports.ChoroplethPropTypes=M,exports.GeoMap=G,exports.GeoMapCanvas=D,exports.GeoMapCanvasDefaultProps=W,exports.GeoMapCanvasPropTypes=R,exports.GeoMapDefaultProps=k,exports.GeoMapPropTypes=y,exports.ResponsiveChoropleth=function(e){return d.jsx(r.ResponsiveWrapper,{children:function(r){var t=r.width,o=r.height;return d.jsx(N,g({width:t,height:o},e))}})},exports.ResponsiveChoroplethCanvas=function(e){return d.jsx(r.ResponsiveWrapper,{children:function(r){var t=r.width,o=r.height;return d.jsx(A,g({width:t,height:o},e))}})},exports.ResponsiveGeoMap=function(e){return d.jsx(r.ResponsiveWrapper,{children:function(r){var t=r.width,o=r.height;return d.jsx(G,g({width:t,height:o},e))}})},exports.ResponsiveGeoMapCanvas=function(e){return d.jsx(r.ResponsiveWrapper,{children:function(r){var t=r.width,o=r.height;return d.jsx(D,g({width:t,height:o},e))}})},exports.projectionById=v,exports.useChoropleth=m,exports.useGeoMap=C;
//# sourceMappingURL=nivo-geo.cjs.js.map
