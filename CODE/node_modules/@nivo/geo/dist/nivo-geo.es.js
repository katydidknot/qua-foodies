import{useMemo as e,memo as r,useCallback as o,Fragment as t,useRef as i,useEffect as n}from"react";import{useTheme as a,guessQuantizeColorScale as u,quantizeColorScalePropType as l,useDimensions as c,SvgWrapper as d,withContainer as s,ResponsiveWrapper as f,getRelativeCursor as h}from"@nivo/core";import{BasicTooltip as p,useTooltip as g}from"@nivo/tooltip";import v from"prop-types";import{useInheritedColor as m,inheritedColorPropType as C}from"@nivo/colors";import b from"lodash/get";import y from"lodash/isFunction";import{format as R}from"d3-format";import{geoAzimuthalEqualArea as j,geoAzimuthalEquidistant as q,geoGnomonic as T,geoOrthographic as M,geoStereographic as W,geoEqualEarth as w,geoEquirectangular as k,geoMercator as F,geoTransverseMercator as O,geoNaturalEarth1 as L,geoPath as E,geoGraticule as S,geoContains as G}from"d3-geo";import{useQuantizeColorScaleLegendData as x,BoxLegendSvg as B,renderLegendToCanvas as P}from"@nivo/legends";import{jsx as N}from"react/jsx-runtime";function H(){return H=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},H.apply(this,arguments)}var I={azimuthalEqualArea:j,azimuthalEquidistant:q,gnomonic:T,orthographic:M,stereographic:W,equalEarth:w,equirectangular:k,mercator:F,transverseMercator:O,naturalEarth1:L},D=function(r){var o=r.width,t=r.height,i=r.projectionType,n=r.projectionScale,u=r.projectionTranslation,l=r.projectionRotation,c=r.fillColor,d=r.borderWidth,s=r.borderColor,f=e((function(){return I[i]().scale(n).translate([o*u[0],t*u[1]]).rotate(l)}),[o,t,i,n,u[0],u[1],l[0],l[1],l[2]]),h=e((function(){return E(f)}),[f]),p=e((function(){return S()})),g=a(),v=e((function(){return"function"==typeof d?d:function(){return d}}),[d]),C=m(s,g),b=e((function(){return"function"==typeof c?c:function(){return c}}),[c]);return{projection:f,path:h,graticule:p,getBorderWidth:v,getBorderColor:C,getFillColor:b}},z=function(r){var o=r.features,t=r.data,i=r.match,n=r.label,a=r.value,l=r.valueFormat,c=r.colors,d=r.unknownColor,s=r.domain,f=e((function(){return y(i)?i:function(e,r){var o=b(e,i),t=b(r,i);return o&&o===t}}),[i]),h=e((function(){return y(n)?n:function(e){return b(e,n)}}),[n]),p=e((function(){return y(a)?a:function(e){return b(e,a)}}),[a]),g=e((function(){return void 0===l?function(e){return e}:y(l)?l:R(l)}),[l]),v=e((function(){return u(c).domain(s)}),[c,s]),m=e((function(){return function(e){return void 0===e.value?d:v(e.value)}}),[v,d]),C=e((function(){return o.map((function(e){var r=t.find((function(r){return f(e,r)})),o=p(r);if(r){var i=H({},e,{data:r,value:o,formattedValue:g(o)});return i.color=m(i),i.label=h(i),i}return e}))}),[o,t,f,p,g,m]),j=x({scale:v,valueFormat:g});return{colorScale:v,getFillColor:m,boundFeatures:C,valueFormatter:g,legendData:j}},V=r((function(e){var r=e.feature;return void 0===r.data?null:N(p,{id:r.label,color:r.color,enableChip:!0,value:r.formattedValue})}));V.propTypes={feature:v.object.isRequired},V.displayName="ChoroplethTooltip";var A={features:v.arrayOf(v.shape({id:v.string.isRequired,type:v.oneOf(["Feature"]).isRequired,properties:v.object,geometry:v.object.isRequired})).isRequired,projectionType:v.oneOf(Object.keys(I)).isRequired,projectionScale:v.number.isRequired,projectionTranslation:v.arrayOf(v.number).isRequired,projectionRotation:v.arrayOf(v.number).isRequired,fillColor:v.oneOfType([v.string,v.func]).isRequired,borderWidth:v.oneOfType([v.number,v.func]).isRequired,borderColor:C.isRequired,enableGraticule:v.bool.isRequired,graticuleLineWidth:v.number.isRequired,graticuleLineColor:v.string.isRequired,isInteractive:v.bool.isRequired,onMouseEnter:v.func.isRequired,onMouseMove:v.func.isRequired,onMouseLeave:v.func.isRequired,onClick:v.func.isRequired,tooltip:v.any,layers:v.arrayOf(v.oneOfType([v.oneOf(["graticule","features"]),v.func])).isRequired},J=H({},A,{role:v.string.isRequired}),K=H({pixelRatio:v.number.isRequired},A),Q={data:v.arrayOf(v.object).isRequired,match:v.oneOfType([v.string,v.func]).isRequired,label:v.oneOfType([v.string,v.func]).isRequired,value:v.oneOfType([v.string,v.func]).isRequired,valueFormat:v.oneOfType([v.string,v.func]),colors:l.isRequired,domain:v.arrayOf(v.number).isRequired,unknownColor:v.string.isRequired,layers:v.arrayOf(v.oneOfType([v.oneOf(["graticule","features","legends"]),v.func])).isRequired},U=H({},J,Q,{role:v.string.isRequired}),X=H({},K,Q),Y={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[]},Z=H({},Y,{role:"img"}),$=H({},Y,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),_={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:V,layers:["graticule","features","legends"]},ee=H({},Z,_,{role:"img"}),re=H({},$,_),oe=r((function(e){var r=e.path,o=e.graticule,t=e.lineWidth,i=e.lineColor;return N("path",{fill:"none",strokeWidth:t,stroke:i,d:r(o())})}));oe.propTypes={path:v.func.isRequired,graticule:v.func.isRequired,lineWidth:v.number.isRequired,lineColor:v.string.isRequired},oe.displayName="GeoGraticule";var te=r((function(e){var r=e.feature,o=e.path,t=e.fillColor,i=e.borderWidth,n=e.borderColor,a=e.onClick,u=e.onMouseEnter,l=e.onMouseMove,c=e.onMouseLeave;return N("path",{fill:t,strokeWidth:i,stroke:n,strokeLinejoin:"bevel",d:o(r),onMouseEnter:function(e){return u(r,e)},onMouseMove:function(e){return l(r,e)},onMouseLeave:function(e){return c(r,e)},onClick:function(e){return a(r,e)}},r.id)}));te.propTypes={feature:v.shape({id:v.string.isRequired,type:v.oneOf(["Feature"]).isRequired,properties:v.object,geometry:v.object.isRequired}).isRequired,path:v.func.isRequired,fillColor:v.string.isRequired,borderWidth:v.number.isRequired,borderColor:v.string.isRequired,onMouseEnter:v.func.isRequired,onMouseMove:v.func.isRequired,onMouseLeave:v.func.isRequired,onClick:v.func.isRequired},te.displayName="GeoMapFeature";var ie=r((function(e){var r=e.width,i=e.height,n=e.margin,u=e.features,l=e.layers,s=e.projectionType,f=e.projectionScale,h=e.projectionTranslation,p=e.projectionRotation,v=e.fillColor,m=e.borderWidth,C=e.borderColor,b=e.enableGraticule,y=e.graticuleLineWidth,R=e.graticuleLineColor,j=e.isInteractive,q=e.onClick,T=e.tooltip,M=e.role,W=c(r,i,n),w=W.margin,k=W.outerWidth,F=W.outerHeight,O=D({width:r,height:i,projectionType:s,projectionScale:f,projectionTranslation:h,projectionRotation:p,fillColor:v,borderWidth:m,borderColor:C}),L=O.graticule,E=O.path,S=O.getFillColor,G=O.getBorderWidth,x=O.getBorderColor,B=a(),P=g(),H=P.showTooltipFromEvent,I=P.hideTooltip,z=o((function(e,r){return j&&q&&q(e,r)}),[j,q]),V=o((function(e,r){return j&&T&&H(N(T,{feature:e}),r)}),[j,H,T]),A=o((function(e,r){return j&&T&&H(N(T,{feature:e}),r)}),[j,H,T]),J=o((function(){return j&&I()}),[j,I]);return N(d,{width:k,height:F,margin:w,theme:B,role:M,children:l.map((function(r,o){return"graticule"===r?!0!==b?null:N(oe,{path:E,graticule:L,lineWidth:y,lineColor:R},"graticule"):"features"===r?N(t,{children:u.map((function(e){return N(te,{feature:e,path:E,fillColor:S(e),borderWidth:G(e),borderColor:x(e),onMouseEnter:V,onMouseMove:A,onMouseLeave:J,onClick:z},e.id)}))},"features"):N(t,{children:r(e)},o)}))})}));ie.displayName="GeoMap",ie.propTypes=J,ie.defaultProps=Z;var ne=s(ie),ae=function(e){return N(f,{children:function(r){var o=r.width,t=r.height;return N(ne,H({width:o,height:t},e))}})},ue=function(e,r,o,t){var i=h(r,e),n=i[0],a=i[1];return o.find((function(e){return G(e,t.invert([n,a]))}))},le=r((function(e){var r=e.width,t=e.height,u=e.margin,l=e.pixelRatio,d=e.features,s=e.layers,f=e.projectionType,h=e.projectionScale,p=e.projectionTranslation,v=e.projectionRotation,m=e.fillColor,C=e.borderWidth,b=e.borderColor,y=e.enableGraticule,R=e.graticuleLineWidth,j=e.graticuleLineColor,q=e.isInteractive,T=e.onClick,M=e.onMouseMove,W=e.tooltip,w=i(null),k=a(),F=c(r,t,u),O=F.margin,L=F.outerWidth,E=F.outerHeight,S=D({width:r,height:t,projectionType:f,projectionScale:h,projectionTranslation:p,projectionRotation:v,fillColor:m,borderWidth:C,borderColor:b}),G=S.projection,x=S.graticule,B=S.path,P=S.getFillColor,H=S.getBorderWidth,I=S.getBorderColor;n((function(){if(w){w.current.width=L*l,w.current.height=E*l;var r=w.current.getContext("2d");r.scale(l,l),r.fillStyle=k.background,r.fillRect(0,0,L,E),r.translate(O.left,O.top),B.context(r),s.forEach((function(o){"graticule"===o?!0===y&&(r.lineWidth=R,r.strokeStyle=j,r.beginPath(),B(x()),r.stroke()):"features"===o?d.forEach((function(e){r.beginPath(),B(e),r.fillStyle=P(e),r.fill();var o=H(e);o>0&&(r.strokeStyle=I(e),r.lineWidth=o,r.stroke())})):o(r,e)}))}}),[w,L,E,O,l,k,B,x,P,H,I,d,s]);var z=g(),V=z.showTooltipFromEvent,A=z.hideTooltip,J=o((function(e){if(q&&W){var r=ue(e,w.current,d,G);r?V(N(W,{feature:r}),e):A(),M&&M(r||null,e)}}),[V,A,q,W,w,d,G]),K=o((function(){return q&&A()}),[q,A]),Q=o((function(e){if(q&&T){var r=ue(e,w.current,d,G);r&&T(r,e)}}),[q,w,d,G,T]);return N("canvas",{ref:w,width:L*l,height:E*l,style:{width:L,height:E,cursor:q?"auto":"normal"},onMouseMove:J,onMouseLeave:K,onClick:Q})}));le.displatName="GeoMapCanvas",le.propTypes=K,le.defaultProps=$;var ce=s(le),de=function(e){return N(f,{children:function(r){var o=r.width,t=r.height;return N(ce,H({width:o,height:t},e))}})},se=r((function(e){var r=e.width,i=e.height,n=e.margin,u=e.features,l=e.data,s=e.match,f=e.label,h=e.value,p=e.valueFormat,v=e.projectionType,m=e.projectionScale,C=e.projectionTranslation,b=e.projectionRotation,y=e.colors,R=e.domain,j=e.unknownColor,q=e.borderWidth,T=e.borderColor,M=e.enableGraticule,W=e.graticuleLineWidth,w=e.graticuleLineColor,k=e.layers,F=e.legends,O=e.isInteractive,L=e.onClick,E=e.tooltip,S=e.role,G=c(r,i,n),x=G.margin,P=G.outerWidth,I=G.outerHeight,V=D({width:r,height:i,projectionType:v,projectionScale:m,projectionTranslation:C,projectionRotation:b,fillColor:function(){},borderWidth:q,borderColor:T}),A=V.graticule,J=V.path,K=V.getBorderWidth,Q=V.getBorderColor,U=z({features:u,data:l,match:s,label:f,value:h,valueFormat:p,colors:y,unknownColor:j,domain:R}),X=U.getFillColor,Y=U.boundFeatures,Z=U.legendData,$=a(),_=g(),ee=_.showTooltipFromEvent,re=_.hideTooltip,ie=o((function(e,r){return O&&L&&L(e,r)}),[O,L]),ne=o((function(e,r){return O&&E&&ee(N(E,{feature:e}),r)}),[O,ee,E]),ae=o((function(e,r){return O&&E&&ee(N(E,{feature:e}),r)}),[O,ee,E]),ue=o((function(){return O&&re()}),[O,re]);return N(d,{width:P,height:I,margin:x,theme:$,role:S,children:k.map((function(e,o){return"graticule"===e?!0!==M?null:N(oe,{path:J,graticule:A,lineWidth:W,lineColor:w},"graticule"):"features"===e?N(t,{children:Y.map((function(e){return N(te,{feature:e,path:J,fillColor:X(e),borderWidth:K(e),borderColor:Q(e),onMouseEnter:ne,onMouseMove:ae,onMouseLeave:ue,onClick:ie},e.id)}))},"features"):"legends"===e?F.map((function(e,o){return N(B,H({containerWidth:r,containerHeight:i,data:Z},e),o)})):N(t,{children:e({})},o)}))})}));se.displayName="Choropleth",se.propTypes=U,se.defaultProps=ee;var fe=s(se),he=function(e){return N(f,{children:function(r){var o=r.width,t=r.height;return N(fe,H({width:o,height:t},e))}})},pe=function(e,r,o,t){var i=h(r,e),n=i[0],a=i[1];return o.find((function(e){return G(e,t.invert([n,a]))}))},ge=r((function(e){var r=e.width,t=e.height,u=e.margin,l=e.pixelRatio,d=e.features,s=e.data,f=e.match,h=e.label,p=e.value,v=e.valueFormat,m=e.projectionType,C=e.projectionScale,b=e.projectionTranslation,y=e.projectionRotation,R=e.colors,j=e.domain,q=e.unknownColor,T=e.borderWidth,M=e.borderColor,W=e.enableGraticule,w=e.graticuleLineWidth,k=e.graticuleLineColor,F=e.layers,O=e.legends,L=e.isInteractive,E=e.onClick,S=e.onMouseMove,G=e.tooltip,x=i(null),B=a(),I=c(r,t,u),V=I.margin,A=I.outerWidth,J=I.outerHeight,K=D({width:r,height:t,projectionType:m,projectionScale:C,projectionTranslation:b,projectionRotation:y,fillColor:function(){},borderWidth:T,borderColor:M}),Q=K.projection,U=K.graticule,X=K.path,Y=K.getBorderWidth,Z=K.getBorderColor,$=z({features:d,data:s,match:f,label:h,value:p,valueFormat:v,colors:R,unknownColor:q,domain:j}),_=$.getFillColor,ee=$.boundFeatures,re=$.legendData;n((function(){if(x){x.current.width=A*l,x.current.height=J*l;var e=x.current.getContext("2d");e.scale(l,l),e.fillStyle=B.background,e.fillRect(0,0,A,J),e.translate(V.left,V.top),X.context(e),F.forEach((function(o){"graticule"===o?!0===W&&(e.lineWidth=w,e.strokeStyle=k,e.beginPath(),X(U()),e.stroke()):"features"===o?ee.forEach((function(r){e.beginPath(),X(r),e.fillStyle=_(r),e.fill();var o=Y(r);o>0&&(e.strokeStyle=Z(r),e.lineWidth=o,e.stroke())})):"legends"===o&&O.forEach((function(o){P(e,H({},o,{data:re,containerWidth:r,containerHeight:t,theme:B}))}))}))}}),[x,A,J,V,l,B,X,U,_,Y,Z,ee,O,F]);var oe=g(),te=oe.showTooltipFromEvent,ie=oe.hideTooltip,ne=o((function(e){if(L&&G){var r=pe(e,x.current,ee,Q);r?te(N(G,{feature:r}),e):ie(),S&&S(r||null,e)}}),[te,ie,L,G,x,ee,Q]),ae=o((function(){return L&&ie()}),[L,ie]),ue=o((function(e){if(L&&E){var r=pe(e,x.current,ee,Q);r&&E(r,e)}}),[L,x,ee,Q,E]);return N("canvas",{ref:x,width:A*l,height:J*l,style:{width:A,height:J,cursor:L?"auto":"normal"},onMouseMove:ne,onMouseLeave:ae,onClick:ue})}));ge.displayName="ChoroplethCanvas",ge.propTypes=X,ge.defaultProps=re;var ve=s(ge),me=function(e){return N(f,{children:function(r){var o=r.width,t=r.height;return N(ve,H({width:o,height:t},e))}})};export{fe as Choropleth,ve as ChoroplethCanvas,re as ChoroplethCanvasDefaultProps,X as ChoroplethCanvasPropTypes,ee as ChoroplethDefaultProps,U as ChoroplethPropTypes,ne as GeoMap,ce as GeoMapCanvas,$ as GeoMapCanvasDefaultProps,K as GeoMapCanvasPropTypes,Z as GeoMapDefaultProps,J as GeoMapPropTypes,he as ResponsiveChoropleth,me as ResponsiveChoroplethCanvas,ae as ResponsiveGeoMap,de as ResponsiveGeoMapCanvas,I as projectionById,z as useChoropleth,D as useGeoMap};
//# sourceMappingURL=nivo-geo.es.js.map
